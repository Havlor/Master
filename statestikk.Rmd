---
title: "T-tester"
author: "HÃ¥vard Crantz Lorentzen"
date: '2023-02-22'
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}

library(tidyverse)
library(knitr)
library(flextable)
library(ggplot2)
library(readxl)
library(kableExtra)
library(ggpubr)
library(dplyr)

data1 <- read_excel("Revidert_resultatskjema.xlsx", na = "NA") #Henter data

endring <- data1 %>%
select(id, time, group, weight, bmi, vo2max_ml_min_kg_6x5,vo2max_ml_min_6x5, lean_mass,`o2_puls (ml)`,hf_max, rer_max_30sek, bfmax_30sek, `Ve_L/min_max_30sek`,time_to_exhaustion, borg_end,lac, `arbec_%_maksHF`,`arbec_%_o2max`,arbec_mean_o2,arbec_vo2_ml_min, arbec_RER, arbec_HF, one_rm_newton,one_rm_watt,pmax_left,pmax_right,fmax_left,fmax_right) %>%
#Velger variabler
filter(id != "tr031 10541") %>%
  filter(id != "tr031 11421") %>%
  filter(id != "tr031 13404") %>%
  filter(id != "tr031 004") %>%
  filter(id != "tr031 008") %>%
  filter(id != "tr031 001") %>%
  filter(id != "tr031 016") %>% #filtrer ut droppouts
group_by(time,group) %>% # grupperer etter tid og FLS/kontroll 
  mutate(n = n()) %>%
  pivot_longer(names_to = "variable", 
               values_to = "value", 
               cols = weight:n) %>%
   pivot_wider(names_from = "time",
              values_from = "value")%>%
    filter(!is.na(pre)) %>%
  filter(!is.na(post)) %>% 
  
  mutate(diff = post - pre) %>%
  pivot_longer(names_to = "time",
               values_to = "value",
               cols = pre:post)%>%
  pivot_wider(names_from = variable,
              values_from = value)
   
  
endringFLS <- endring %>%
  filter(group != "kon")
  
endringKON <- endring %>%
  filter(group != "fls")
  
    
#Normalitetssjekk
difFLS <- with(endringFLS, vo2max_ml_min_kg_6x5[time == "pre"] - vo2max_ml_min_kg_6x5[time == "post"])

shapiro.test(difFLS)

difKON <- with(endringKON, vo2max_ml_min_kg_6x5[time == "pre"] - vo2max_ml_min_kg_6x5[time == "post"])

shapiro.test(difKON)

#parret T-test
t_testFLS <- t.test(vo2max_ml_min_kg_6x5 ~ time, data = endringFLS, paired = TRUE)

t_testKON <- t.test(vo2max_ml_min_kg_6x5 ~ time, data = endringKON , paired = TRUE)

```


